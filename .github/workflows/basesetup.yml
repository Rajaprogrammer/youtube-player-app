# .github/workflows/build.yml
name: Create Flutter YouTube Viewer App

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: write

jobs:
  create-flutter-project:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Setup Java
        uses: actions/setup-java@v4
        with:
          distribution: 'zulu'
          java-version: '17'
          cache: 'gradle'

      - name: Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.3'
          channel: 'stable'
          cache: true

      - name: Cache pub dependencies
        uses: actions/cache@v4
        with:
          path: |
            ~/.pub-cache
          key: ${{ runner.os }}-pub-v2-${{ hashFiles('**/pubspec.yaml') }}
          restore-keys: |
            ${{ runner.os }}-pub-v2-

      - name: Create Flutter Project
        run: |
          flutter create --project-name youtube_viewer --org com.youtubeviewer --platforms android youtube_viewer_app

      - name: Create pubspec.yaml
        run: |
          cat > youtube_viewer_app/pubspec.yaml << 'PUBSPEC_EOF'
          name: youtube_viewer
          description: A beautiful YouTube video viewer app with JSON import/export.
          publish_to: 'none'
          version: 1.0.0+1

          environment:
            sdk: '>=3.0.0 <4.0.0'

          dependencies:
            flutter:
              sdk: flutter
            cupertino_icons: ^1.0.8
            youtube_player_flutter: 9.0.3
            file_picker: ^8.1.2
            path_provider: ^2.1.4
            google_fonts: ^6.2.1
            shimmer: ^3.0.0
            share_plus: ^10.0.2
            url_launcher: ^6.3.0
            cached_network_image: ^3.4.1
            permission_handler: ^11.3.1
            animate_do: ^3.3.4

          dev_dependencies:
            flutter_test:
              sdk: flutter
            flutter_lints: ^4.0.0

          flutter:
            uses-material-design: true
            assets:
              - assets/
          PUBSPEC_EOF

      - name: Create directory structure
        run: |
          mkdir -p youtube_viewer_app/lib/models
          mkdir -p youtube_viewer_app/lib/screens
          mkdir -p youtube_viewer_app/lib/widgets
          mkdir -p youtube_viewer_app/lib/services
          mkdir -p youtube_viewer_app/lib/theme
          mkdir -p youtube_viewer_app/assets

      - name: Create default JSON asset
        run: |
          cat > youtube_viewer_app/assets/default_videos.json << 'JSON_EOF'
          {
            "app_title": "My YouTube Viewer",
            "theme_color": "#6C63FF",
            "accent_color": "#FF6584",
            "videos": [
              {
                "id": "1",
                "title": "Flutter in 100 Seconds",
                "url": "https://www.youtube.com/watch?v=lHn9RCpxEeY",
                "category": "Flutter",
                "description": "Learn Flutter basics in 100 seconds"
              },
              {
                "id": "2",
                "title": "Dart in 100 Seconds",
                "url": "https://www.youtube.com/watch?v=NrO0CJCbYLA",
                "category": "Dart",
                "description": "Learn Dart programming language basics"
              },
              {
                "id": "3",
                "title": "Firebase in 100 Seconds",
                "url": "https://www.youtube.com/watch?v=vAoB4VbhRzM",
                "category": "Firebase",
                "description": "Learn Firebase basics in 100 seconds"
              }
            ]
          }
          JSON_EOF

      - name: Create App Theme
        run: |
          cat > youtube_viewer_app/lib/theme/app_theme.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:google_fonts/google_fonts.dart';

          class AppTheme {
            static Color primaryColor = const Color(0xFF6C63FF);
            static Color accentColor = const Color(0xFFFF6584);
            static const Color darkBg = Color(0xFF0A0E21);
            static const Color darkCard = Color(0xFF1D1E33);
            static const Color darkCardLight = Color(0xFF252840);
            static const Color surfaceWhite = Color(0xFFF8F9FA);
            static const Color textPrimary = Color(0xFFFFFFFF);
            static const Color textSecondary = Color(0xFFB0B3C5);
            static const Color successGreen = Color(0xFF00D68F);
            static const Color warningOrange = Color(0xFFFFAA00);
            static const Color errorRed = Color(0xFFFF3D71);

            static void updateColors(String? primary, String? accent) {
              if (primary != null && primary.isNotEmpty) {
                try {
                  primaryColor = Color(
                    int.parse(primary.replaceFirst('#', '0xFF')),
                  );
                } catch (_) {}
              }
              if (accent != null && accent.isNotEmpty) {
                try {
                  accentColor = Color(
                    int.parse(accent.replaceFirst('#', '0xFF')),
                  );
                } catch (_) {}
              }
            }

            static ThemeData get darkTheme {
              return ThemeData(
                brightness: Brightness.dark,
                primaryColor: primaryColor,
                scaffoldBackgroundColor: darkBg,
                colorScheme: ColorScheme.dark(
                  primary: primaryColor,
                  secondary: accentColor,
                  surface: darkCard,
                  onPrimary: Colors.white,
                  onSecondary: Colors.white,
                  onSurface: textPrimary,
                ),
                textTheme: GoogleFonts.poppinsTextTheme(
                  ThemeData.dark().textTheme,
                ),
                appBarTheme: AppBarTheme(
                  backgroundColor: darkBg,
                  elevation: 0,
                  centerTitle: false,
                  titleTextStyle: GoogleFonts.poppins(
                    fontSize: 22,
                    fontWeight: FontWeight.w700,
                    color: textPrimary,
                  ),
                  iconTheme: const IconThemeData(color: textPrimary),
                ),
                cardTheme: CardTheme(
                  color: darkCard,
                  elevation: 8,
                  shadowColor: Colors.black.withOpacity(0.3),
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(20),
                  ),
                ),
                elevatedButtonTheme: ElevatedButtonThemeData(
                  style: ElevatedButton.styleFrom(
                    backgroundColor: primaryColor,
                    foregroundColor: Colors.white,
                    elevation: 4,
                    shadowColor: primaryColor.withOpacity(0.4),
                    padding: const EdgeInsets.symmetric(
                      horizontal: 24,
                      vertical: 14,
                    ),
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(16),
                    ),
                    textStyle: GoogleFonts.poppins(
                      fontSize: 16,
                      fontWeight: FontWeight.w600,
                    ),
                  ),
                ),
                snackBarTheme: SnackBarThemeData(
                  backgroundColor: darkCardLight,
                  contentTextStyle: GoogleFonts.poppins(color: textPrimary),
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(12),
                  ),
                  behavior: SnackBarBehavior.floating,
                ),
                dialogTheme: DialogTheme(
                  backgroundColor: darkCard,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(24),
                  ),
                  titleTextStyle: GoogleFonts.poppins(
                    fontSize: 20,
                    fontWeight: FontWeight.w700,
                    color: textPrimary,
                  ),
                  contentTextStyle: GoogleFonts.poppins(
                    fontSize: 14,
                    color: textSecondary,
                  ),
                ),
                inputDecorationTheme: InputDecorationTheme(
                  filled: true,
                  fillColor: darkCardLight,
                  border: OutlineInputBorder(
                    borderRadius: BorderRadius.circular(16),
                    borderSide: BorderSide.none,
                  ),
                  enabledBorder: OutlineInputBorder(
                    borderRadius: BorderRadius.circular(16),
                    borderSide: BorderSide(
                      color: Colors.white.withOpacity(0.05),
                    ),
                  ),
                  focusedBorder: OutlineInputBorder(
                    borderRadius: BorderRadius.circular(16),
                    borderSide: BorderSide(color: primaryColor, width: 2),
                  ),
                  hintStyle: GoogleFonts.poppins(
                    color: textSecondary.withOpacity(0.5),
                  ),
                  labelStyle: GoogleFonts.poppins(color: textSecondary),
                  contentPadding: const EdgeInsets.symmetric(
                    horizontal: 20,
                    vertical: 16,
                  ),
                ),
              );
            }
          }
          DART_EOF

      - name: Create Video Model
        run: |
          cat > youtube_viewer_app/lib/models/video_model.dart << 'DART_EOF'
          import 'dart:convert';

          class VideoItem {
            final String id;
            final String title;
            final String url;
            final String category;
            final String description;

            VideoItem({
              required this.id,
              required this.title,
              required this.url,
              this.category = 'General',
              this.description = '',
            });

            String get youtubeId {
              final uri = Uri.tryParse(url);
              if (uri == null) return '';

              if (uri.host.contains('youtu.be')) {
                return uri.pathSegments.isNotEmpty ? uri.pathSegments.first : '';
              }

              if (uri.host.contains('youtube.com')) {
                if (uri.queryParameters.containsKey('v')) {
                  return uri.queryParameters['v'] ?? '';
                }
                if (uri.pathSegments.contains('embed') &&
                    uri.pathSegments.length > 1) {
                  final idx = uri.pathSegments.indexOf('embed');
                  if (idx + 1 < uri.pathSegments.length) {
                    return uri.pathSegments[idx + 1];
                  }
                }
                if (uri.pathSegments.contains('shorts') &&
                    uri.pathSegments.length > 1) {
                  final idx = uri.pathSegments.indexOf('shorts');
                  if (idx + 1 < uri.pathSegments.length) {
                    return uri.pathSegments[idx + 1];
                  }
                }
              }

              return url;
            }

            String get thumbnailUrl =>
                'https://img.youtube.com/vi/$youtubeId/hqdefault.jpg';

            String get highResThumbnailUrl =>
                'https://img.youtube.com/vi/$youtubeId/maxresdefault.jpg';

            factory VideoItem.fromJson(Map<String, dynamic> json) {
              return VideoItem(
                id: json['id']?.toString() ??
                    DateTime.now().millisecondsSinceEpoch.toString(),
                title: json['title'] ?? 'Untitled',
                url: json['url'] ?? '',
                category: json['category'] ?? 'General',
                description: json['description'] ?? '',
              );
            }

            Map<String, dynamic> toJson() => {
                  'id': id,
                  'title': title,
                  'url': url,
                  'category': category,
                  'description': description,
                };
          }

          class AppData {
            final String appTitle;
            final String themeColor;
            final String accentColor;
            final List<VideoItem> videos;

            AppData({
              required this.appTitle,
              this.themeColor = '#6C63FF',
              this.accentColor = '#FF6584',
              required this.videos,
            });

            factory AppData.fromJson(Map<String, dynamic> json) {
              final videosList = (json['videos'] as List<dynamic>?)
                      ?.map((v) => VideoItem.fromJson(v as Map<String, dynamic>))
                      .toList() ??
                  [];
              return AppData(
                appTitle: json['app_title'] ?? 'YouTube Viewer',
                themeColor: json['theme_color'] ?? '#6C63FF',
                accentColor: json['accent_color'] ?? '#FF6584',
                videos: videosList,
              );
            }

            Map<String, dynamic> toJson() => {
                  'app_title': appTitle,
                  'theme_color': themeColor,
                  'accent_color': accentColor,
                  'videos': videos.map((v) => v.toJson()).toList(),
                };

            String toJsonString() =>
                const JsonEncoder.withIndent('  ').convert(toJson());

            AppData copyWith({
              String? appTitle,
              String? themeColor,
              String? accentColor,
              List<VideoItem>? videos,
            }) {
              return AppData(
                appTitle: appTitle ?? this.appTitle,
                themeColor: themeColor ?? this.themeColor,
                accentColor: accentColor ?? this.accentColor,
                videos: videos ?? this.videos,
              );
            }
          }
          DART_EOF

      - name: Create Data Service
        run: |
          cat > youtube_viewer_app/lib/services/data_service.dart << 'DART_EOF'
          import 'dart:convert';
          import 'dart:io';
          import 'package:flutter/foundation.dart';
          import 'package:flutter/services.dart';
          import 'package:file_picker/file_picker.dart';
          import 'package:path_provider/path_provider.dart';
          import 'package:share_plus/share_plus.dart';
          import '../models/video_model.dart';

          class DataService {
            static const String _fileName = 'youtube_viewer_data.json';

            static Future<AppData> loadData() async {
              try {
                final dir = await getApplicationDocumentsDirectory();
                final file = File('${dir.path}/$_fileName');
                if (await file.exists()) {
                  final content = await file.readAsString();
                  final json = jsonDecode(content) as Map<String, dynamic>;
                  return AppData.fromJson(json);
                }
              } catch (e) {
                debugPrint('Error loading saved data: $e');
              }

              try {
                final content =
                    await rootBundle.loadString('assets/default_videos.json');
                final json = jsonDecode(content) as Map<String, dynamic>;
                return AppData.fromJson(json);
              } catch (e) {
                debugPrint('Error loading default data: $e');
                return AppData(appTitle: 'YouTube Viewer', videos: []);
              }
            }

            static Future<void> saveData(AppData data) async {
              try {
                final dir = await getApplicationDocumentsDirectory();
                final file = File('${dir.path}/$_fileName');
                await file.writeAsString(data.toJsonString());
              } catch (e) {
                debugPrint('Error saving data: $e');
              }
            }

            static Future<AppData?> importJson() async {
              try {
                final result = await FilePicker.platform.pickFiles(
                  type: FileType.custom,
                  allowedExtensions: ['json'],
                  withData: true,
                );

                if (result != null && result.files.single.bytes != null) {
                  final content = utf8.decode(result.files.single.bytes!);
                  final json = jsonDecode(content) as Map<String, dynamic>;
                  final data = AppData.fromJson(json);
                  await saveData(data);
                  return data;
                }
              } catch (e) {
                debugPrint('Error importing JSON: $e');
                rethrow;
              }
              return null;
            }

            static Future<void> exportJson(AppData data) async {
              try {
                final jsonString = data.toJsonString();
                final dir = await getApplicationDocumentsDirectory();
                final file = File('${dir.path}/youtube_viewer_export.json');
                await file.writeAsString(jsonString);

                await Share.shareXFiles(
                  [XFile(file.path)],
                  subject: 'YouTube Viewer Data',
                  text: 'YouTube Viewer configuration file',
                );
              } catch (e) {
                debugPrint('Error exporting JSON: $e');
                rethrow;
              }
            }
          }
          DART_EOF

      - name: Create Video Card Widget
        run: |
          cat > youtube_viewer_app/lib/widgets/video_card.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:google_fonts/google_fonts.dart';
          import 'package:cached_network_image/cached_network_image.dart';
          import 'package:shimmer/shimmer.dart';
          import '../models/video_model.dart';
          import '../theme/app_theme.dart';

          class VideoCard extends StatefulWidget {
            final VideoItem video;
            final VoidCallback onTap;
            final VoidCallback? onDelete;
            final int index;

            const VideoCard({
              super.key,
              required this.video,
              required this.onTap,
              this.onDelete,
              required this.index,
            });

            @override
            State<VideoCard> createState() => _VideoCardState();
          }

          class _VideoCardState extends State<VideoCard>
              with SingleTickerProviderStateMixin {
            late AnimationController _controller;
            late Animation<double> _scaleAnimation;
            bool _isPressed = false;

            @override
            void initState() {
              super.initState();
              _controller = AnimationController(
                duration: const Duration(milliseconds: 150),
                vsync: this,
              );
              _scaleAnimation = Tween<double>(begin: 1.0, end: 0.95).animate(
                CurvedAnimation(parent: _controller, curve: Curves.easeInOut),
              );
            }

            @override
            void dispose() {
              _controller.dispose();
              super.dispose();
            }

            @override
            Widget build(BuildContext context) {
              return AnimatedBuilder(
                listenable: _scaleAnimation,
                builder: (context, child) {
                  return Transform.scale(
                    scale: _scaleAnimation.value,
                    child: child,
                  );
                },
                child: _buildCard(),
              );
            }

            Widget _buildCard() {
              return GestureDetector(
                onTapDown: (_) {
                  setState(() => _isPressed = true);
                  _controller.forward();
                },
                onTapUp: (_) {
                  setState(() => _isPressed = false);
                  _controller.reverse();
                  widget.onTap();
                },
                onTapCancel: () {
                  setState(() => _isPressed = false);
                  _controller.reverse();
                },
                child: Container(
                  margin: const EdgeInsets.only(bottom: 20),
                  decoration: BoxDecoration(
                    borderRadius: BorderRadius.circular(24),
                    boxShadow: [
                      BoxShadow(
                        color: AppTheme.primaryColor.withOpacity(
                          _isPressed ? 0.3 : 0.15,
                        ),
                        blurRadius: _isPressed ? 25 : 15,
                        offset: const Offset(0, 8),
                        spreadRadius: _isPressed ? 2 : 0,
                      ),
                      BoxShadow(
                        color: Colors.black.withOpacity(0.2),
                        blurRadius: 10,
                        offset: const Offset(0, 4),
                      ),
                    ],
                  ),
                  child: ClipRRect(
                    borderRadius: BorderRadius.circular(24),
                    child: Container(
                      color: AppTheme.darkCard,
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          _buildThumbnail(),
                          _buildContent(),
                        ],
                      ),
                    ),
                  ),
                ),
              );
            }

            Widget _buildThumbnail() {
              return Stack(
                children: [
                  AspectRatio(
                    aspectRatio: 16 / 9,
                    child: CachedNetworkImage(
                      imageUrl: widget.video.thumbnailUrl,
                      fit: BoxFit.cover,
                      placeholder: (context, url) => Shimmer.fromColors(
                        baseColor: AppTheme.darkCardLight,
                        highlightColor: AppTheme.darkCard.withOpacity(0.5),
                        child: Container(color: AppTheme.darkCardLight),
                      ),
                      errorWidget: (context, url, error) => Container(
                        color: AppTheme.darkCardLight,
                        child: Center(
                          child: Icon(
                            Icons.play_circle_outline_rounded,
                            size: 64,
                            color: AppTheme.primaryColor.withOpacity(0.5),
                          ),
                        ),
                      ),
                    ),
                  ),
                  Positioned.fill(
                    child: Container(
                      decoration: BoxDecoration(
                        gradient: LinearGradient(
                          begin: Alignment.topCenter,
                          end: Alignment.bottomCenter,
                          colors: [
                            Colors.transparent,
                            Colors.black.withOpacity(0.7),
                          ],
                          stops: const [0.5, 1.0],
                        ),
                      ),
                    ),
                  ),
                  Positioned.fill(
                    child: Center(
                      child: Container(
                        width: 64,
                        height: 64,
                        decoration: BoxDecoration(
                          color: AppTheme.primaryColor.withOpacity(0.9),
                          shape: BoxShape.circle,
                          boxShadow: [
                            BoxShadow(
                              color: AppTheme.primaryColor.withOpacity(0.4),
                              blurRadius: 20,
                              spreadRadius: 4,
                            ),
                          ],
                        ),
                        child: const Icon(
                          Icons.play_arrow_rounded,
                          color: Colors.white,
                          size: 36,
                        ),
                      ),
                    ),
                  ),
                  if (widget.video.category.isNotEmpty)
                    Positioned(
                      top: 12,
                      left: 12,
                      child: Container(
                        padding: const EdgeInsets.symmetric(
                          horizontal: 12,
                          vertical: 6,
                        ),
                        decoration: BoxDecoration(
                          color: AppTheme.accentColor.withOpacity(0.9),
                          borderRadius: BorderRadius.circular(20),
                          boxShadow: [
                            BoxShadow(
                              color: AppTheme.accentColor.withOpacity(0.3),
                              blurRadius: 8,
                              offset: const Offset(0, 2),
                            ),
                          ],
                        ),
                        child: Text(
                          widget.video.category,
                          style: GoogleFonts.poppins(
                            fontSize: 11,
                            fontWeight: FontWeight.w600,
                            color: Colors.white,
                          ),
                        ),
                      ),
                    ),
                  if (widget.onDelete != null)
                    Positioned(
                      top: 12,
                      right: 12,
                      child: GestureDetector(
                        onTap: widget.onDelete,
                        child: Container(
                          width: 36,
                          height: 36,
                          decoration: BoxDecoration(
                            color: AppTheme.errorRed.withOpacity(0.9),
                            shape: BoxShape.circle,
                            boxShadow: [
                              BoxShadow(
                                color: Colors.black.withOpacity(0.3),
                                blurRadius: 8,
                              ),
                            ],
                          ),
                          child: const Icon(
                            Icons.delete_outline_rounded,
                            color: Colors.white,
                            size: 18,
                          ),
                        ),
                      ),
                    ),
                ],
              );
            }

            Widget _buildContent() {
              return Padding(
                padding: const EdgeInsets.all(16),
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      widget.video.title,
                      style: GoogleFonts.poppins(
                        fontSize: 17,
                        fontWeight: FontWeight.w700,
                        color: AppTheme.textPrimary,
                        height: 1.3,
                      ),
                      maxLines: 2,
                      overflow: TextOverflow.ellipsis,
                    ),
                    if (widget.video.description.isNotEmpty) ...[
                      const SizedBox(height: 6),
                      Text(
                        widget.video.description,
                        style: GoogleFonts.poppins(
                          fontSize: 13,
                          color: AppTheme.textSecondary,
                          height: 1.4,
                        ),
                        maxLines: 2,
                        overflow: TextOverflow.ellipsis,
                      ),
                    ],
                    const SizedBox(height: 12),
                    Row(
                      children: [
                        Icon(
                          Icons.play_circle_fill_rounded,
                          color: AppTheme.primaryColor,
                          size: 18,
                        ),
                        const SizedBox(width: 6),
                        Text(
                          'Tap to play',
                          style: GoogleFonts.poppins(
                            fontSize: 12,
                            color: AppTheme.primaryColor,
                            fontWeight: FontWeight.w500,
                          ),
                        ),
                        const Spacer(),
                        Container(
                          padding: const EdgeInsets.symmetric(
                            horizontal: 10,
                            vertical: 4,
                          ),
                          decoration: BoxDecoration(
                            color: AppTheme.primaryColor.withOpacity(0.1),
                            borderRadius: BorderRadius.circular(8),
                            border: Border.all(
                              color: AppTheme.primaryColor.withOpacity(0.2),
                            ),
                          ),
                          child: Text(
                            'YouTube',
                            style: GoogleFonts.poppins(
                              fontSize: 11,
                              fontWeight: FontWeight.w600,
                              color: AppTheme.primaryColor,
                            ),
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              );
            }
          }

          class AnimatedBuilder extends StatelessWidget {
            final Listenable listenable;
            final Widget Function(BuildContext, Widget?) builder;
            final Widget? child;

            const AnimatedBuilder({
              super.key,
              required this.listenable,
              required this.builder,
              this.child,
            });

            @override
            Widget build(BuildContext context) {
              return AnimatedWidget2(
                listenable: listenable,
                builder: builder,
                child: child,
              );
            }
          }

          class AnimatedWidget2 extends StatefulWidget {
            final Listenable listenable;
            final Widget Function(BuildContext, Widget?) builder;
            final Widget? child;

            const AnimatedWidget2({
              super.key,
              required this.listenable,
              required this.builder,
              this.child,
            });

            @override
            State<AnimatedWidget2> createState() => _AnimatedWidget2State();
          }

          class _AnimatedWidget2State extends State<AnimatedWidget2> {
            @override
            void initState() {
              super.initState();
              widget.listenable.addListener(_onChanged);
            }

            @override
            void didUpdateWidget(AnimatedWidget2 oldWidget) {
              super.didUpdateWidget(oldWidget);
              if (oldWidget.listenable != widget.listenable) {
                oldWidget.listenable.removeListener(_onChanged);
                widget.listenable.addListener(_onChanged);
              }
            }

            @override
            void dispose() {
              widget.listenable.removeListener(_onChanged);
              super.dispose();
            }

            void _onChanged() {
              setState(() {});
            }

            @override
            Widget build(BuildContext context) {
              return widget.builder(context, widget.child);
            }
          }
          DART_EOF

      - name: Create Add Video Dialog
        run: |
          cat > youtube_viewer_app/lib/widgets/add_video_dialog.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:google_fonts/google_fonts.dart';
          import '../models/video_model.dart';
          import '../theme/app_theme.dart';

          class AddVideoDialog extends StatefulWidget {
            const AddVideoDialog({super.key});

            @override
            State<AddVideoDialog> createState() => _AddVideoDialogState();
          }

          class _AddVideoDialogState extends State<AddVideoDialog>
              with SingleTickerProviderStateMixin {
            final _formKey = GlobalKey<FormState>();
            final _titleController = TextEditingController();
            final _urlController = TextEditingController();
            final _categoryController = TextEditingController();
            final _descController = TextEditingController();
            late AnimationController _animController;
            late Animation<double> _fadeAnim;

            @override
            void initState() {
              super.initState();
              _animController = AnimationController(
                duration: const Duration(milliseconds: 400),
                vsync: this,
              );
              _fadeAnim = CurvedAnimation(
                parent: _animController,
                curve: Curves.easeOutCubic,
              );
              _animController.forward();
            }

            @override
            void dispose() {
              _titleController.dispose();
              _urlController.dispose();
              _categoryController.dispose();
              _descController.dispose();
              _animController.dispose();
              super.dispose();
            }

            @override
            Widget build(BuildContext context) {
              return FadeTransition(
                opacity: _fadeAnim,
                child: ScaleTransition(
                  scale: _fadeAnim,
                  child: Dialog(
                    insetPadding: const EdgeInsets.all(20),
                    child: Container(
                      constraints: const BoxConstraints(maxWidth: 500),
                      padding: const EdgeInsets.all(28),
                      decoration: BoxDecoration(
                        color: AppTheme.darkCard,
                        borderRadius: BorderRadius.circular(28),
                        border: Border.all(
                          color: Colors.white.withOpacity(0.08),
                        ),
                        boxShadow: [
                          BoxShadow(
                            color: AppTheme.primaryColor.withOpacity(0.1),
                            blurRadius: 40,
                            spreadRadius: 5,
                          ),
                        ],
                      ),
                      child: SingleChildScrollView(
                        child: Form(
                          key: _formKey,
                          child: Column(
                            mainAxisSize: MainAxisSize.min,
                            crossAxisAlignment: CrossAxisAlignment.stretch,
                            children: [
                              Row(
                                children: [
                                  Container(
                                    width: 48,
                                    height: 48,
                                    decoration: BoxDecoration(
                                      gradient: LinearGradient(
                                        colors: [
                                          AppTheme.primaryColor,
                                          AppTheme.accentColor,
                                        ],
                                      ),
                                      borderRadius: BorderRadius.circular(16),
                                      boxShadow: [
                                        BoxShadow(
                                          color: AppTheme.primaryColor
                                              .withOpacity(0.3),
                                          blurRadius: 12,
                                          offset: const Offset(0, 4),
                                        ),
                                      ],
                                    ),
                                    child: const Icon(
                                      Icons.add_rounded,
                                      color: Colors.white,
                                      size: 28,
                                    ),
                                  ),
                                  const SizedBox(width: 16),
                                  Expanded(
                                    child: Column(
                                      crossAxisAlignment:
                                          CrossAxisAlignment.start,
                                      children: [
                                        Text(
                                          'Add Video',
                                          style: GoogleFonts.poppins(
                                            fontSize: 22,
                                            fontWeight: FontWeight.w700,
                                            color: AppTheme.textPrimary,
                                          ),
                                        ),
                                        Text(
                                          'Enter YouTube video details',
                                          style: GoogleFonts.poppins(
                                            fontSize: 13,
                                            color: AppTheme.textSecondary,
                                          ),
                                        ),
                                      ],
                                    ),
                                  ),
                                  GestureDetector(
                                    onTap: () => Navigator.pop(context),
                                    child: Container(
                                      width: 36,
                                      height: 36,
                                      decoration: BoxDecoration(
                                        color: Colors.white.withOpacity(0.05),
                                        shape: BoxShape.circle,
                                      ),
                                      child: const Icon(
                                        Icons.close_rounded,
                                        color: AppTheme.textSecondary,
                                        size: 20,
                                      ),
                                    ),
                                  ),
                                ],
                              ),
                              const SizedBox(height: 28),
                              _buildLabel('Video Title', Icons.title_rounded),
                              const SizedBox(height: 8),
                              TextFormField(
                                controller: _titleController,
                                style: GoogleFonts.poppins(
                                    color: AppTheme.textPrimary),
                                decoration: const InputDecoration(
                                  hintText: 'e.g., Flutter Tutorial #1',
                                ),
                                validator: (v) =>
                                    v?.isEmpty == true ? 'Required' : null,
                              ),
                              const SizedBox(height: 20),
                              _buildLabel('YouTube URL', Icons.link_rounded),
                              const SizedBox(height: 8),
                              TextFormField(
                                controller: _urlController,
                                style: GoogleFonts.poppins(
                                    color: AppTheme.textPrimary),
                                decoration: const InputDecoration(
                                  hintText:
                                      'https://www.youtube.com/watch?v=...',
                                ),
                                validator: (v) {
                                  if (v?.isEmpty == true) return 'Required';
                                  if (!v!.contains('youtube.com') &&
                                      !v.contains('youtu.be')) {
                                    return 'Enter a valid YouTube URL';
                                  }
                                  return null;
                                },
                              ),
                              const SizedBox(height: 20),
                              _buildLabel('Category', Icons.category_rounded),
                              const SizedBox(height: 8),
                              TextFormField(
                                controller: _categoryController,
                                style: GoogleFonts.poppins(
                                    color: AppTheme.textPrimary),
                                decoration: const InputDecoration(
                                  hintText: 'e.g., Flutter, Tutorial',
                                ),
                              ),
                              const SizedBox(height: 20),
                              _buildLabel(
                                  'Description', Icons.description_rounded),
                              const SizedBox(height: 8),
                              TextFormField(
                                controller: _descController,
                                style: GoogleFonts.poppins(
                                    color: AppTheme.textPrimary),
                                maxLines: 3,
                                decoration: const InputDecoration(
                                  hintText: 'Brief description (optional)',
                                ),
                              ),
                              const SizedBox(height: 32),
                              Row(
                                children: [
                                  Expanded(
                                    child: OutlinedButton(
                                      onPressed: () => Navigator.pop(context),
                                      style: OutlinedButton.styleFrom(
                                        foregroundColor: AppTheme.textSecondary,
                                        side: BorderSide(
                                          color:
                                              Colors.white.withOpacity(0.1),
                                        ),
                                        padding: const EdgeInsets.symmetric(
                                            vertical: 16),
                                        shape: RoundedRectangleBorder(
                                          borderRadius:
                                              BorderRadius.circular(16),
                                        ),
                                      ),
                                      child: Text(
                                        'Cancel',
                                        style: GoogleFonts.poppins(
                                            fontWeight: FontWeight.w600),
                                      ),
                                    ),
                                  ),
                                  const SizedBox(width: 16),
                                  Expanded(
                                    flex: 2,
                                    child: Container(
                                      decoration: BoxDecoration(
                                        gradient: LinearGradient(
                                          colors: [
                                            AppTheme.primaryColor,
                                            AppTheme.accentColor,
                                          ],
                                        ),
                                        borderRadius:
                                            BorderRadius.circular(16),
                                        boxShadow: [
                                          BoxShadow(
                                            color: AppTheme.primaryColor
                                                .withOpacity(0.4),
                                            blurRadius: 12,
                                            offset: const Offset(0, 4),
                                          ),
                                        ],
                                      ),
                                      child: ElevatedButton(
                                        onPressed: _submit,
                                        style: ElevatedButton.styleFrom(
                                          backgroundColor: Colors.transparent,
                                          shadowColor: Colors.transparent,
                                          padding:
                                              const EdgeInsets.symmetric(
                                                  vertical: 16),
                                          shape: RoundedRectangleBorder(
                                            borderRadius:
                                                BorderRadius.circular(16),
                                          ),
                                        ),
                                        child: Row(
                                          mainAxisAlignment:
                                              MainAxisAlignment.center,
                                          children: [
                                            const Icon(Icons.add_rounded,
                                                size: 20),
                                            const SizedBox(width: 8),
                                            Text(
                                              'Add Video',
                                              style: GoogleFonts.poppins(
                                                fontWeight: FontWeight.w600,
                                                fontSize: 15,
                                              ),
                                            ),
                                          ],
                                        ),
                                      ),
                                    ),
                                  ),
                                ],
                              ),
                            ],
                          ),
                        ),
                      ),
                    ),
                  ),
                ),
              );
            }

            Widget _buildLabel(String text, IconData icon) {
              return Row(
                children: [
                  Icon(icon, size: 16, color: AppTheme.primaryColor),
                  const SizedBox(width: 8),
                  Text(
                    text,
                    style: GoogleFonts.poppins(
                      fontSize: 13,
                      fontWeight: FontWeight.w600,
                      color: AppTheme.textSecondary,
                    ),
                  ),
                ],
              );
            }

            void _submit() {
              if (_formKey.currentState!.validate()) {
                final video = VideoItem(
                  id: DateTime.now().millisecondsSinceEpoch.toString(),
                  title: _titleController.text.trim(),
                  url: _urlController.text.trim(),
                  category: _categoryController.text.trim().isEmpty
                      ? 'General'
                      : _categoryController.text.trim(),
                  description: _descController.text.trim(),
                );
                Navigator.pop(context, video);
              }
            }
          }
          DART_EOF

      - name: Create Player Screen
        run: |
          cat > youtube_viewer_app/lib/screens/player_screen.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:flutter/services.dart';
          import 'package:youtube_player_flutter/youtube_player_flutter.dart';
          import 'package:google_fonts/google_fonts.dart';
          import '../models/video_model.dart';
          import '../theme/app_theme.dart';

          class PlayerScreen extends StatefulWidget {
            final VideoItem video;

            const PlayerScreen({super.key, required this.video});

            @override
            State<PlayerScreen> createState() => _PlayerScreenState();
          }

          class _PlayerScreenState extends State<PlayerScreen> {
            late YoutubePlayerController _ytController;

            @override
            void initState() {
              super.initState();
              _ytController = YoutubePlayerController(
                initialVideoId: widget.video.youtubeId,
                flags: const YoutubePlayerFlags(
                  autoPlay: true,
                  mute: false,
                  enableCaption: true,
                  forceHD: true,
                ),
              );
            }

            @override
            void dispose() {
              _ytController.dispose();
              SystemChrome.setPreferredOrientations([
                DeviceOrientation.portraitUp,
              ]);
              SystemChrome.setEnabledSystemUIMode(
                SystemUiMode.manual,
                overlays: SystemUiOverlay.values,
              );
              super.dispose();
            }

            @override
            Widget build(BuildContext context) {
              return YoutubePlayerBuilder(
                onExitFullScreen: () {
                  SystemChrome.setPreferredOrientations([
                    DeviceOrientation.portraitUp,
                  ]);
                },
                player: YoutubePlayer(
                  controller: _ytController,
                  showVideoProgressIndicator: true,
                  progressIndicatorColor: AppTheme.primaryColor,
                  progressColors: ProgressBarColors(
                    playedColor: AppTheme.primaryColor,
                    handleColor: AppTheme.accentColor,
                    bufferedColor: AppTheme.primaryColor.withOpacity(0.3),
                    backgroundColor: Colors.white.withOpacity(0.1),
                  ),
                  topActions: [
                    const SizedBox(width: 8),
                    Expanded(
                      child: Text(
                        widget.video.title,
                        style: GoogleFonts.poppins(
                          color: Colors.white,
                          fontSize: 16,
                          fontWeight: FontWeight.w600,
                        ),
                        overflow: TextOverflow.ellipsis,
                      ),
                    ),
                  ],
                ),
                builder: (context, player) {
                  return Scaffold(
                    backgroundColor: AppTheme.darkBg,
                    appBar: AppBar(
                      backgroundColor: AppTheme.darkBg,
                      leading: IconButton(
                        icon: Container(
                          width: 40,
                          height: 40,
                          decoration: BoxDecoration(
                            color: Colors.white.withOpacity(0.08),
                            borderRadius: BorderRadius.circular(12),
                          ),
                          child: const Icon(
                            Icons.arrow_back_ios_new_rounded,
                            size: 18,
                          ),
                        ),
                        onPressed: () => Navigator.pop(context),
                      ),
                      title: Text(
                        'Now Playing',
                        style: GoogleFonts.poppins(
                          fontSize: 18,
                          fontWeight: FontWeight.w600,
                        ),
                      ),
                    ),
                    body: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        ClipRRect(
                          borderRadius: const BorderRadius.vertical(
                            bottom: Radius.circular(24),
                          ),
                          child: player,
                        ),
                        const SizedBox(height: 24),
                        Expanded(
                          child: SingleChildScrollView(
                            padding:
                                const EdgeInsets.symmetric(horizontal: 20),
                            child: Column(
                              crossAxisAlignment: CrossAxisAlignment.start,
                              children: [
                                Text(
                                  widget.video.title,
                                  style: GoogleFonts.poppins(
                                    fontSize: 24,
                                    fontWeight: FontWeight.w700,
                                    color: AppTheme.textPrimary,
                                    height: 1.3,
                                  ),
                                ),
                                const SizedBox(height: 12),
                                Container(
                                  padding: const EdgeInsets.symmetric(
                                    horizontal: 14,
                                    vertical: 8,
                                  ),
                                  decoration: BoxDecoration(
                                    gradient: LinearGradient(
                                      colors: [
                                        AppTheme.primaryColor
                                            .withOpacity(0.2),
                                        AppTheme.accentColor
                                            .withOpacity(0.1),
                                      ],
                                    ),
                                    borderRadius: BorderRadius.circular(12),
                                    border: Border.all(
                                      color: AppTheme.primaryColor
                                          .withOpacity(0.3),
                                    ),
                                  ),
                                  child: Row(
                                    mainAxisSize: MainAxisSize.min,
                                    children: [
                                      Icon(
                                        Icons.category_rounded,
                                        size: 16,
                                        color: AppTheme.primaryColor,
                                      ),
                                      const SizedBox(width: 8),
                                      Text(
                                        widget.video.category,
                                        style: GoogleFonts.poppins(
                                          fontSize: 13,
                                          fontWeight: FontWeight.w600,
                                          color: AppTheme.primaryColor,
                                        ),
                                      ),
                                    ],
                                  ),
                                ),
                                if (widget.video.description
                                    .isNotEmpty) ...[
                                  const SizedBox(height: 20),
                                  Container(
                                    width: double.infinity,
                                    padding: const EdgeInsets.all(20),
                                    decoration: BoxDecoration(
                                      color: AppTheme.darkCardLight,
                                      borderRadius:
                                          BorderRadius.circular(20),
                                      border: Border.all(
                                        color:
                                            Colors.white.withOpacity(0.05),
                                      ),
                                    ),
                                    child: Column(
                                      crossAxisAlignment:
                                          CrossAxisAlignment.start,
                                      children: [
                                        Text(
                                          'Description',
                                          style: GoogleFonts.poppins(
                                            fontSize: 15,
                                            fontWeight: FontWeight.w600,
                                            color: AppTheme.textPrimary,
                                          ),
                                        ),
                                        const SizedBox(height: 8),
                                        Text(
                                          widget.video.description,
                                          style: GoogleFonts.poppins(
                                            fontSize: 14,
                                            color: AppTheme.textSecondary,
                                            height: 1.6,
                                          ),
                                        ),
                                      ],
                                    ),
                                  ),
                                ],
                                const SizedBox(height: 30),
                              ],
                            ),
                          ),
                        ),
                      ],
                    ),
                  );
                },
              );
            }
          }
          DART_EOF

      - name: Create Home Screen
        run: |
          cat > youtube_viewer_app/lib/screens/home_screen.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:google_fonts/google_fonts.dart';
          import 'package:animate_do/animate_do.dart';
          import '../models/video_model.dart';
          import '../services/data_service.dart';
          import '../theme/app_theme.dart';
          import '../widgets/video_card.dart';
          import '../widgets/add_video_dialog.dart';
          import 'player_screen.dart';

          class HomeScreen extends StatefulWidget {
            const HomeScreen({super.key});

            @override
            State<HomeScreen> createState() => _HomeScreenState();
          }

          class _HomeScreenState extends State<HomeScreen>
              with TickerProviderStateMixin {
            AppData? _appData;
            bool _isLoading = true;
            String _selectedCategory = 'All';
            final ScrollController _scrollController = ScrollController();

            @override
            void initState() {
              super.initState();
              _loadData();
            }

            @override
            void dispose() {
              _scrollController.dispose();
              super.dispose();
            }

            Future<void> _loadData() async {
              setState(() => _isLoading = true);
              final data = await DataService.loadData();
              AppTheme.updateColors(data.themeColor, data.accentColor);
              setState(() {
                _appData = data;
                _isLoading = false;
              });
            }

            List<String> get _categories {
              if (_appData == null) return ['All'];
              final cats = _appData!.videos
                  .map((v) => v.category)
                  .where((c) => c.isNotEmpty)
                  .toSet()
                  .toList();
              cats.sort();
              return ['All', ...cats];
            }

            List<VideoItem> get _filteredVideos {
              if (_appData == null) return [];
              if (_selectedCategory == 'All') return _appData!.videos;
              return _appData!.videos
                  .where((v) => v.category == _selectedCategory)
                  .toList();
            }

            Future<void> _importJson() async {
              try {
                final data = await DataService.importJson();
                if (data != null) {
                  AppTheme.updateColors(data.themeColor, data.accentColor);
                  setState(() {
                    _appData = data;
                    _selectedCategory = 'All';
                  });
                  if (mounted) {
                    _showSnackBar(
                        'Data imported successfully!', AppTheme.successGreen);
                  }
                }
              } catch (e) {
                if (mounted) {
                  _showSnackBar('Failed to import: $e', AppTheme.errorRed);
                }
              }
            }

            Future<void> _exportJson() async {
              if (_appData == null) return;
              try {
                await DataService.exportJson(_appData!);
                if (mounted) {
                  _showSnackBar(
                      'Data exported successfully!', AppTheme.successGreen);
                }
              } catch (e) {
                if (mounted) {
                  _showSnackBar('Failed to export: $e', AppTheme.errorRed);
                }
              }
            }

            void _showSnackBar(String message, Color color) {
              ScaffoldMessenger.of(context).showSnackBar(
                SnackBar(
                  content: Row(
                    children: [
                      Icon(
                        color == AppTheme.successGreen
                            ? Icons.check_circle_rounded
                            : Icons.error_rounded,
                        color: color,
                        size: 20,
                      ),
                      const SizedBox(width: 12),
                      Expanded(
                        child: Text(
                          message,
                          style: GoogleFonts.poppins(
                              fontWeight: FontWeight.w500),
                        ),
                      ),
                    ],
                  ),
                  behavior: SnackBarBehavior.floating,
                  margin: const EdgeInsets.all(16),
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(16),
                  ),
                  duration: const Duration(seconds: 3),
                ),
              );
            }

            Future<void> _addVideo() async {
              final video = await showDialog<VideoItem>(
                context: context,
                barrierDismissible: true,
                builder: (_) => const AddVideoDialog(),
              );

              if (video != null && _appData != null) {
                final updatedData = _appData!.copyWith(
                  videos: [..._appData!.videos, video],
                );
                await DataService.saveData(updatedData);
                setState(() => _appData = updatedData);
                _showSnackBar(
                    'Video added successfully!', AppTheme.successGreen);
              }
            }

            Future<void> _deleteVideo(VideoItem video) async {
              final confirm = await showDialog<bool>(
                context: context,
                builder: (ctx) => AlertDialog(
                  title: Text(
                    'Delete Video',
                    style: GoogleFonts.poppins(fontWeight: FontWeight.w700),
                  ),
                  content: Text(
                    'Are you sure you want to remove "${video.title}"?',
                  ),
                  actions: [
                    TextButton(
                      onPressed: () => Navigator.pop(ctx, false),
                      child: Text(
                        'Cancel',
                        style: GoogleFonts.poppins(
                          color: AppTheme.textSecondary,
                          fontWeight: FontWeight.w600,
                        ),
                      ),
                    ),
                    ElevatedButton(
                      onPressed: () => Navigator.pop(ctx, true),
                      style: ElevatedButton.styleFrom(
                        backgroundColor: AppTheme.errorRed,
                      ),
                      child: Text(
                        'Delete',
                        style:
                            GoogleFonts.poppins(fontWeight: FontWeight.w600),
                      ),
                    ),
                  ],
                ),
              );

              if (confirm == true && _appData != null) {
                final updatedVideos =
                    _appData!.videos.where((v) => v.id != video.id).toList();
                final updatedData =
                    _appData!.copyWith(videos: updatedVideos);
                await DataService.saveData(updatedData);
                setState(() => _appData = updatedData);
                _showSnackBar(
                    'Video removed successfully!', AppTheme.warningOrange);
              }
            }

            void _openPlayer(VideoItem video) {
              Navigator.push(
                context,
                PageRouteBuilder(
                  pageBuilder: (_, __, ___) => PlayerScreen(video: video),
                  transitionsBuilder: (_, anim, __, child) {
                    return FadeTransition(
                      opacity: anim,
                      child: SlideTransition(
                        position: Tween<Offset>(
                          begin: const Offset(0, 0.05),
                          end: Offset.zero,
                        ).animate(CurvedAnimation(
                          parent: anim,
                          curve: Curves.easeOutCubic,
                        )),
                        child: child,
                      ),
                    );
                  },
                  transitionDuration: const Duration(milliseconds: 400),
                ),
              );
            }

            void _showOptionsMenu() {
              showModalBottomSheet(
                context: context,
                backgroundColor: Colors.transparent,
                isScrollControlled: true,
                builder: (ctx) => Container(
                  margin: const EdgeInsets.all(16),
                  decoration: BoxDecoration(
                    color: AppTheme.darkCard,
                    borderRadius: BorderRadius.circular(28),
                    border: Border.all(
                      color: Colors.white.withOpacity(0.08),
                    ),
                  ),
                  child: Column(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      const SizedBox(height: 12),
                      Container(
                        width: 40,
                        height: 4,
                        decoration: BoxDecoration(
                          color: Colors.white.withOpacity(0.2),
                          borderRadius: BorderRadius.circular(2),
                        ),
                      ),
                      const SizedBox(height: 20),
                      Text(
                        'Options',
                        style: GoogleFonts.poppins(
                          fontSize: 20,
                          fontWeight: FontWeight.w700,
                          color: AppTheme.textPrimary,
                        ),
                      ),
                      const SizedBox(height: 20),
                      _buildOptionTile(
                        icon: Icons.file_download_rounded,
                        title: 'Import JSON',
                        subtitle: 'Load videos from a JSON file',
                        color: AppTheme.primaryColor,
                        onTap: () {
                          Navigator.pop(ctx);
                          _importJson();
                        },
                      ),
                      _buildOptionTile(
                        icon: Icons.file_upload_rounded,
                        title: 'Export JSON',
                        subtitle: 'Save current data as JSON',
                        color: AppTheme.accentColor,
                        onTap: () {
                          Navigator.pop(ctx);
                          _exportJson();
                        },
                      ),
                      _buildOptionTile(
                        icon: Icons.add_circle_rounded,
                        title: 'Add Video',
                        subtitle: 'Add a new YouTube video',
                        color: AppTheme.successGreen,
                        onTap: () {
                          Navigator.pop(ctx);
                          _addVideo();
                        },
                      ),
                      const SizedBox(height: 16),
                      Padding(
                        padding: const EdgeInsets.symmetric(horizontal: 20),
                        child: SizedBox(
                          width: double.infinity,
                          child: OutlinedButton(
                            onPressed: () => Navigator.pop(ctx),
                            style: OutlinedButton.styleFrom(
                              foregroundColor: AppTheme.textSecondary,
                              side: BorderSide(
                                color: Colors.white.withOpacity(0.1),
                              ),
                              padding: const EdgeInsets.symmetric(
                                  vertical: 16),
                              shape: RoundedRectangleBorder(
                                borderRadius: BorderRadius.circular(16),
                              ),
                            ),
                            child: Text(
                              'Close',
                              style: GoogleFonts.poppins(
                                  fontWeight: FontWeight.w600),
                            ),
                          ),
                        ),
                      ),
                      const SizedBox(height: 20),
                    ],
                  ),
                ),
              );
            }

            Widget _buildOptionTile({
              required IconData icon,
              required String title,
              required String subtitle,
              required Color color,
              required VoidCallback onTap,
            }) {
              return Padding(
                padding:
                    const EdgeInsets.symmetric(horizontal: 16, vertical: 4),
                child: Material(
                  color: Colors.transparent,
                  child: InkWell(
                    onTap: onTap,
                    borderRadius: BorderRadius.circular(16),
                    child: Container(
                      padding: const EdgeInsets.all(16),
                      decoration: BoxDecoration(
                        color: color.withOpacity(0.08),
                        borderRadius: BorderRadius.circular(16),
                        border: Border.all(color: color.withOpacity(0.15)),
                      ),
                      child: Row(
                        children: [
                          Container(
                            width: 48,
                            height: 48,
                            decoration: BoxDecoration(
                              color: color.withOpacity(0.15),
                              borderRadius: BorderRadius.circular(14),
                            ),
                            child: Icon(icon, color: color, size: 24),
                          ),
                          const SizedBox(width: 16),
                          Expanded(
                            child: Column(
                              crossAxisAlignment:
                                  CrossAxisAlignment.start,
                              children: [
                                Text(
                                  title,
                                  style: GoogleFonts.poppins(
                                    fontSize: 15,
                                    fontWeight: FontWeight.w600,
                                    color: AppTheme.textPrimary,
                                  ),
                                ),
                                Text(
                                  subtitle,
                                  style: GoogleFonts.poppins(
                                    fontSize: 12,
                                    color: AppTheme.textSecondary,
                                  ),
                                ),
                              ],
                            ),
                          ),
                          Icon(
                            Icons.arrow_forward_ios_rounded,
                            color: color.withOpacity(0.5),
                            size: 16,
                          ),
                        ],
                      ),
                    ),
                  ),
                ),
              );
            }

            @override
            Widget build(BuildContext context) {
              if (_isLoading) {
                return Scaffold(
                  backgroundColor: AppTheme.darkBg,
                  body: Center(
                    child: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        SizedBox(
                          width: 60,
                          height: 60,
                          child: CircularProgressIndicator(
                            strokeWidth: 3,
                            valueColor: AlwaysStoppedAnimation<Color>(
                              AppTheme.primaryColor,
                            ),
                          ),
                        ),
                        const SizedBox(height: 24),
                        Text(
                          'Loading...',
                          style: GoogleFonts.poppins(
                            fontSize: 16,
                            color: AppTheme.textSecondary,
                            fontWeight: FontWeight.w500,
                          ),
                        ),
                      ],
                    ),
                  ),
                );
              }

              final videos = _filteredVideos;

              return Scaffold(
                backgroundColor: AppTheme.darkBg,
                body: CustomScrollView(
                  controller: _scrollController,
                  physics: const BouncingScrollPhysics(),
                  slivers: [
                    SliverAppBar(
                      expandedHeight: 140,
                      floating: false,
                      pinned: true,
                      backgroundColor: AppTheme.darkBg,
                      flexibleSpace: FlexibleSpaceBar(
                        titlePadding:
                            const EdgeInsets.only(left: 20, bottom: 16),
                        title: FadeInLeft(
                          duration: const Duration(milliseconds: 600),
                          child: Row(
                            children: [
                              Container(
                                width: 8,
                                height: 24,
                                decoration: BoxDecoration(
                                  gradient: LinearGradient(
                                    begin: Alignment.topCenter,
                                    end: Alignment.bottomCenter,
                                    colors: [
                                      AppTheme.primaryColor,
                                      AppTheme.accentColor,
                                    ],
                                  ),
                                  borderRadius: BorderRadius.circular(4),
                                ),
                              ),
                              const SizedBox(width: 10),
                              Flexible(
                                child: Text(
                                  _appData?.appTitle ?? 'YouTube Viewer',
                                  style: GoogleFonts.poppins(
                                    fontSize: 20,
                                    fontWeight: FontWeight.w800,
                                    color: AppTheme.textPrimary,
                                  ),
                                  overflow: TextOverflow.ellipsis,
                                ),
                              ),
                            ],
                          ),
                        ),
                        background: Container(
                          decoration: BoxDecoration(
                            gradient: LinearGradient(
                              begin: Alignment.topLeft,
                              end: Alignment.bottomRight,
                              colors: [
                                AppTheme.primaryColor.withOpacity(0.15),
                                AppTheme.darkBg,
                              ],
                            ),
                          ),
                        ),
                      ),
                      actions: [
                        FadeInRight(
                          duration: const Duration(milliseconds: 600),
                          child: Padding(
                            padding: const EdgeInsets.only(right: 12),
                            child: GestureDetector(
                              onTap: _showOptionsMenu,
                              child: Container(
                                width: 44,
                                height: 44,
                                decoration: BoxDecoration(
                                  color: Colors.white.withOpacity(0.08),
                                  borderRadius: BorderRadius.circular(14),
                                  border: Border.all(
                                    color: Colors.white.withOpacity(0.06),
                                  ),
                                ),
                                child: const Icon(
                                  Icons.more_vert_rounded,
                                  color: AppTheme.textPrimary,
                                  size: 22,
                                ),
                              ),
                            ),
                          ),
                        ),
                      ],
                    ),
                    SliverToBoxAdapter(
                      child: FadeInUp(
                        duration: const Duration(milliseconds: 500),
                        delay: const Duration(milliseconds: 200),
                        child: Padding(
                          padding:
                              const EdgeInsets.fromLTRB(20, 8, 20, 4),
                          child: Row(
                            children: [
                              _buildStatChip(
                                Icons.play_circle_rounded,
                                '${_appData?.videos.length ?? 0} videos',
                                AppTheme.primaryColor,
                              ),
                              const SizedBox(width: 10),
                              _buildStatChip(
                                Icons.category_rounded,
                                '${_categories.length - 1} categories',
                                AppTheme.accentColor,
                              ),
                            ],
                          ),
                        ),
                      ),
                    ),
                    if (_categories.length > 1)
                      SliverToBoxAdapter(
                        child: FadeInUp(
                          duration: const Duration(milliseconds: 500),
                          delay: const Duration(milliseconds: 300),
                          child: SizedBox(
                            height: 64,
                            child: ListView.builder(
                              scrollDirection: Axis.horizontal,
                              padding: const EdgeInsets.symmetric(
                                horizontal: 16,
                                vertical: 12,
                              ),
                              itemCount: _categories.length,
                              itemBuilder: (ctx, i) {
                                final cat = _categories[i];
                                final isSelected =
                                    cat == _selectedCategory;
                                return Padding(
                                  padding:
                                      const EdgeInsets.only(right: 10),
                                  child: GestureDetector(
                                    onTap: () => setState(() =>
                                        _selectedCategory = cat),
                                    child: AnimatedContainer(
                                      duration: const Duration(
                                          milliseconds: 300),
                                      curve: Curves.easeOutCubic,
                                      padding:
                                          const EdgeInsets.symmetric(
                                        horizontal: 18,
                                        vertical: 8,
                                      ),
                                      decoration: BoxDecoration(
                                        gradient: isSelected
                                            ? LinearGradient(
                                                colors: [
                                                  AppTheme.primaryColor,
                                                  AppTheme.accentColor,
                                                ],
                                              )
                                            : null,
                                        color: isSelected
                                            ? null
                                            : Colors.white
                                                .withOpacity(0.05),
                                        borderRadius:
                                            BorderRadius.circular(14),
                                        border: isSelected
                                            ? null
                                            : Border.all(
                                                color: Colors.white
                                                    .withOpacity(0.08),
                                              ),
                                        boxShadow: isSelected
                                            ? [
                                                BoxShadow(
                                                  color: AppTheme
                                                      .primaryColor
                                                      .withOpacity(0.3),
                                                  blurRadius: 10,
                                                  offset:
                                                      const Offset(0, 3),
                                                ),
                                              ]
                                            : null,
                                      ),
                                      child: Text(
                                        cat,
                                        style: GoogleFonts.poppins(
                                          fontSize: 13,
                                          fontWeight: isSelected
                                              ? FontWeight.w700
                                              : FontWeight.w500,
                                          color: isSelected
                                              ? Colors.white
                                              : AppTheme.textSecondary,
                                        ),
                                      ),
                                    ),
                                  ),
                                );
                              },
                            ),
                          ),
                        ),
                      ),
                    if (videos.isEmpty)
                      SliverFillRemaining(
                        hasScrollBody: false,
                        child: FadeInUp(
                          duration: const Duration(milliseconds: 600),
                          child: _buildEmptyState(),
                        ),
                      )
                    else
                      SliverPadding(
                        padding:
                            const EdgeInsets.fromLTRB(20, 8, 20, 100),
                        sliver: SliverList(
                          delegate: SliverChildBuilderDelegate(
                            (ctx, i) {
                              final video = videos[i];
                              return FadeInUp(
                                duration:
                                    const Duration(milliseconds: 500),
                                delay: Duration(
                                    milliseconds: 100 + (i * 80)),
                                child: VideoCard(
                                  video: video,
                                  index: i,
                                  onTap: () => _openPlayer(video),
                                  onDelete: () => _deleteVideo(video),
                                ),
                              );
                            },
                            childCount: videos.length,
                          ),
                        ),
                      ),
                  ],
                ),
                floatingActionButton: videos.isNotEmpty
                    ? FadeInUp(
                        duration: const Duration(milliseconds: 600),
                        delay: const Duration(milliseconds: 500),
                        child: Container(
                          decoration: BoxDecoration(
                            gradient: LinearGradient(
                              colors: [
                                AppTheme.primaryColor,
                                AppTheme.accentColor,
                              ],
                            ),
                            borderRadius: BorderRadius.circular(20),
                            boxShadow: [
                              BoxShadow(
                                color: AppTheme.primaryColor
                                    .withOpacity(0.4),
                                blurRadius: 16,
                                offset: const Offset(0, 6),
                                spreadRadius: 2,
                              ),
                            ],
                          ),
                          child: FloatingActionButton.extended(
                            onPressed: _addVideo,
                            backgroundColor: Colors.transparent,
                            elevation: 0,
                            highlightElevation: 0,
                            icon: const Icon(Icons.add_rounded),
                            label: Text(
                              'Add Video',
                              style: GoogleFonts.poppins(
                                  fontWeight: FontWeight.w600),
                            ),
                          ),
                        ),
                      )
                    : null,
              );
            }

            Widget _buildStatChip(IconData icon, String text, Color color) {
              return Container(
                padding: const EdgeInsets.symmetric(
                    horizontal: 14, vertical: 8),
                decoration: BoxDecoration(
                  color: color.withOpacity(0.1),
                  borderRadius: BorderRadius.circular(12),
                  border: Border.all(color: color.withOpacity(0.2)),
                ),
                child: Row(
                  mainAxisSize: MainAxisSize.min,
                  children: [
                    Icon(icon, size: 18, color: color),
                    const SizedBox(width: 8),
                    Text(
                      text,
                      style: GoogleFonts.poppins(
                        fontSize: 13,
                        fontWeight: FontWeight.w600,
                        color: color,
                      ),
                    ),
                  ],
                ),
              );
            }

            Widget _buildEmptyState() {
              return Center(
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    Container(
                      width: 100,
                      height: 100,
                      decoration: BoxDecoration(
                        color: AppTheme.primaryColor.withOpacity(0.1),
                        shape: BoxShape.circle,
                      ),
                      child: Icon(
                        Icons.video_library_rounded,
                        size: 48,
                        color: AppTheme.primaryColor.withOpacity(0.5),
                      ),
                    ),
                    const SizedBox(height: 24),
                    Text(
                      'No Videos Yet',
                      style: GoogleFonts.poppins(
                        fontSize: 22,
                        fontWeight: FontWeight.w700,
                        color: AppTheme.textPrimary,
                      ),
                    ),
                    const SizedBox(height: 8),
                    Text(
                      'Add a video or import a JSON file\nto get started',
                      textAlign: TextAlign.center,
                      style: GoogleFonts.poppins(
                        fontSize: 14,
                        color: AppTheme.textSecondary,
                        height: 1.5,
                      ),
                    ),
                    const SizedBox(height: 32),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        ElevatedButton.icon(
                          onPressed: _addVideo,
                          icon: const Icon(Icons.add_rounded),
                          label: const Text('Add Video'),
                        ),
                        const SizedBox(width: 16),
                        OutlinedButton.icon(
                          onPressed: _importJson,
                          icon: const Icon(Icons.file_download_rounded),
                          label: const Text('Import'),
                          style: OutlinedButton.styleFrom(
                            foregroundColor: AppTheme.primaryColor,
                            side: BorderSide(
                                color: AppTheme.primaryColor),
                            padding: const EdgeInsets.symmetric(
                              horizontal: 24,
                              vertical: 14,
                            ),
                            shape: RoundedRectangleBorder(
                              borderRadius: BorderRadius.circular(16),
                            ),
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              );
            }
          }
          DART_EOF

      - name: Create Splash Screen
        run: |
          cat > youtube_viewer_app/lib/screens/splash_screen.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:google_fonts/google_fonts.dart';
          import 'package:animate_do/animate_do.dart';
          import '../theme/app_theme.dart';
          import 'home_screen.dart';

          class SplashScreen extends StatefulWidget {
            const SplashScreen({super.key});

            @override
            State<SplashScreen> createState() => _SplashScreenState();
          }

          class _SplashScreenState extends State<SplashScreen> {
            @override
            void initState() {
              super.initState();
              Future.delayed(const Duration(milliseconds: 2500), () {
                if (mounted) {
                  Navigator.pushReplacement(
                    context,
                    PageRouteBuilder(
                      pageBuilder: (_, __, ___) => const HomeScreen(),
                      transitionsBuilder: (_, anim, __, child) {
                        return FadeTransition(opacity: anim, child: child);
                      },
                      transitionDuration:
                          const Duration(milliseconds: 600),
                    ),
                  );
                }
              });
            }

            @override
            Widget build(BuildContext context) {
              return Scaffold(
                backgroundColor: AppTheme.darkBg,
                body: Container(
                  width: double.infinity,
                  height: double.infinity,
                  decoration: BoxDecoration(
                    gradient: RadialGradient(
                      center: Alignment.center,
                      radius: 1.2,
                      colors: [
                        AppTheme.primaryColor.withOpacity(0.15),
                        AppTheme.darkBg,
                      ],
                    ),
                  ),
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      FadeInDown(
                        duration: const Duration(milliseconds: 800),
                        child: Container(
                          width: 120,
                          height: 120,
                          decoration: BoxDecoration(
                            gradient: LinearGradient(
                              begin: Alignment.topLeft,
                              end: Alignment.bottomRight,
                              colors: [
                                AppTheme.primaryColor,
                                AppTheme.accentColor,
                              ],
                            ),
                            borderRadius: BorderRadius.circular(36),
                            boxShadow: [
                              BoxShadow(
                                color: AppTheme.primaryColor
                                    .withOpacity(0.4),
                                blurRadius: 30,
                                spreadRadius: 5,
                              ),
                            ],
                          ),
                          child: const Icon(
                            Icons.play_arrow_rounded,
                            size: 64,
                            color: Colors.white,
                          ),
                        ),
                      ),
                      const SizedBox(height: 32),
                      FadeInUp(
                        duration: const Duration(milliseconds: 800),
                        delay: const Duration(milliseconds: 300),
                        child: Text(
                          'YouTube Viewer',
                          style: GoogleFonts.poppins(
                            fontSize: 30,
                            fontWeight: FontWeight.w800,
                            color: AppTheme.textPrimary,
                            letterSpacing: -0.5,
                          ),
                        ),
                      ),
                      const SizedBox(height: 8),
                      FadeInUp(
                        duration: const Duration(milliseconds: 800),
                        delay: const Duration(milliseconds: 500),
                        child: Text(
                          'Your personal video collection',
                          style: GoogleFonts.poppins(
                            fontSize: 15,
                            color: AppTheme.textSecondary,
                            fontWeight: FontWeight.w400,
                          ),
                        ),
                      ),
                      const SizedBox(height: 60),
                      FadeIn(
                        duration: const Duration(milliseconds: 800),
                        delay: const Duration(milliseconds: 800),
                        child: SizedBox(
                          width: 40,
                          height: 40,
                          child: CircularProgressIndicator(
                            strokeWidth: 2.5,
                            valueColor: AlwaysStoppedAnimation<Color>(
                              AppTheme.primaryColor.withOpacity(0.6),
                            ),
                          ),
                        ),
                      ),
                    ],
                  ),
                ),
              );
            }
          }
          DART_EOF

      - name: Create main.dart
        run: |
          cat > youtube_viewer_app/lib/main.dart << 'DART_EOF'
          import 'package:flutter/material.dart';
          import 'package:flutter/services.dart';
          import 'theme/app_theme.dart';
          import 'screens/splash_screen.dart';

          void main() {
            WidgetsFlutterBinding.ensureInitialized();
            SystemChrome.setSystemUIOverlayStyle(
              const SystemUiOverlayStyle(
                statusBarColor: Colors.transparent,
                statusBarIconBrightness: Brightness.light,
                systemNavigationBarColor: AppTheme.darkBg,
                systemNavigationBarIconBrightness: Brightness.light,
              ),
            );
            SystemChrome.setPreferredOrientations([
              DeviceOrientation.portraitUp,
              DeviceOrientation.portraitDown,
            ]).then((_) {
              runApp(const MyApp());
            });
          }

          class MyApp extends StatelessWidget {
            const MyApp({super.key});

            @override
            Widget build(BuildContext context) {
              return MaterialApp(
                title: 'YouTube Viewer',
                debugShowCheckedModeBanner: false,
                theme: AppTheme.darkTheme,
                home: const SplashScreen(),
              );
            }
          }
          DART_EOF

      - name: Fix Android build config
        run: |
          cd youtube_viewer_app/android/app

          # Fix build.gradle - handle both Kotlin DSL and Groovy DSL
          if [ -f "build.gradle.kts" ]; then
            sed -i 's/minSdk = flutter.minSdkVersion/minSdk = 21/' build.gradle.kts
            sed -i 's/minSdk = .*$/minSdk = 21/' build.gradle.kts
          fi

          if [ -f "build.gradle" ]; then
            sed -i 's/flutter.minSdkVersion/21/g' build.gradle
            sed -i 's/minSdkVersion.*/minSdkVersion 21/' build.gradle
            sed -i 's/minSdk.*/minSdk = 21/' build.gradle
          fi

          cd ../../..

      - name: Add Internet permission
        run: |
          # Main manifest
          MANIFEST="youtube_viewer_app/android/app/src/main/AndroidManifest.xml"
          if ! grep -q "android.permission.INTERNET" "$MANIFEST"; then
            sed -i 's/<manifest/<manifest xmlns:tools="http:\/\/schemas.android.com\/tools"/' "$MANIFEST" 2>/dev/null || true
            sed -i '/<application/i\    <uses-permission android:name="android.permission.INTERNET"\/>' "$MANIFEST"
            sed -i '/<application/i\    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"\/>' "$MANIFEST"
            sed -i '/<application/i\    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"\/>' "$MANIFEST"
          fi

          # Add usesCleartextTraffic to application tag
          sed -i 's/<application/<application android:usesCleartextTraffic="true"/' "$MANIFEST" 2>/dev/null || true

      - name: Get dependencies
        working-directory: youtube_viewer_app
        run: flutter pub get

      - name: Remove default test
        run: |
          rm -f youtube_viewer_app/test/widget_test.dart

      - name: Create unit tests
        run: |
          mkdir -p youtube_viewer_app/test
          cat > youtube_viewer_app/test/model_test.dart << 'DART_EOF'
          import 'package:flutter_test/flutter_test.dart';
          import 'package:youtube_viewer/models/video_model.dart';

          void main() {
            group('VideoItem', () {
              test('parses standard YouTube URL', () {
                final video = VideoItem(
                  id: '1',
                  title: 'Test',
                  url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
                );
                expect(video.youtubeId, 'dQw4w9WgXcQ');
              });

              test('parses short YouTube URL', () {
                final video = VideoItem(
                  id: '2',
                  title: 'Test',
                  url: 'https://youtu.be/dQw4w9WgXcQ',
                );
                expect(video.youtubeId, 'dQw4w9WgXcQ');
              });

              test('parses embed YouTube URL', () {
                final video = VideoItem(
                  id: '3',
                  title: 'Test',
                  url: 'https://www.youtube.com/embed/dQw4w9WgXcQ',
                );
                expect(video.youtubeId, 'dQw4w9WgXcQ');
              });

              test('parses shorts YouTube URL', () {
                final video = VideoItem(
                  id: '4',
                  title: 'Test',
                  url: 'https://www.youtube.com/shorts/dQw4w9WgXcQ',
                );
                expect(video.youtubeId, 'dQw4w9WgXcQ');
              });

              test('generates correct thumbnail URL', () {
                final video = VideoItem(
                  id: '1',
                  title: 'Test',
                  url: 'https://www.youtube.com/watch?v=dQw4w9WgXcQ',
                );
                expect(video.thumbnailUrl,
                    'https://img.youtube.com/vi/dQw4w9WgXcQ/hqdefault.jpg');
              });

              test('serializes to JSON correctly', () {
                final video = VideoItem(
                  id: '1',
                  title: 'Test Video',
                  url: 'https://www.youtube.com/watch?v=abc123',
                  category: 'Flutter',
                  description: 'A test video',
                );
                final json = video.toJson();
                expect(json['id'], '1');
                expect(json['title'], 'Test Video');
                expect(json['url'], 'https://www.youtube.com/watch?v=abc123');
                expect(json['category'], 'Flutter');
                expect(json['description'], 'A test video');
              });

              test('deserializes from JSON correctly', () {
                final json = {
                  'id': '1',
                  'title': 'Test',
                  'url': 'https://youtube.com/watch?v=abc',
                  'category': 'Dart',
                  'description': 'desc',
                };
                final video = VideoItem.fromJson(json);
                expect(video.id, '1');
                expect(video.title, 'Test');
                expect(video.category, 'Dart');
              });
            });

            group('AppData', () {
              test('serializes and deserializes correctly', () {
                final data = AppData(
                  appTitle: 'Test App',
                  themeColor: '#FF0000',
                  accentColor: '#00FF00',
                  videos: [
                    VideoItem(
                      id: '1',
                      title: 'V1',
                      url: 'https://youtube.com/watch?v=abc',
                    ),
                  ],
                );
                final json = data.toJson();
                final restored = AppData.fromJson(json);
                expect(restored.appTitle, 'Test App');
                expect(restored.themeColor, '#FF0000');
                expect(restored.accentColor, '#00FF00');
                expect(restored.videos.length, 1);
                expect(restored.videos.first.title, 'V1');
              });

              test('copyWith works correctly', () {
                final data = AppData(
                  appTitle: 'Original',
                  videos: [],
                );
                final copy = data.copyWith(appTitle: 'Modified');
                expect(copy.appTitle, 'Modified');
                expect(data.appTitle, 'Original');
              });

              test('handles missing fields with defaults', () {
                final data = AppData.fromJson({});
                expect(data.appTitle, 'YouTube Viewer');
                expect(data.themeColor, '#6C63FF');
                expect(data.videos.isEmpty, true);
              });

              test('toJsonString produces valid JSON', () {
                final data = AppData(
                  appTitle: 'Test',
                  videos: [],
                );
                final jsonStr = data.toJsonString();
                expect(jsonStr.contains('"app_title": "Test"'), true);
              });
            });
          }
          DART_EOF

      - name: Run tests
        working-directory: youtube_viewer_app
        run: flutter test

      - name: Analyze code
        working-directory: youtube_viewer_app
        run: flutter analyze --no-fatal-infos --no-fatal-warnings

      - name: Build Android APK
        working-directory: youtube_viewer_app
        run: flutter build apk --debug

      - name: Create README
        run: |
          cat > youtube_viewer_app/README.md << 'README_EOF'
          #  YouTube Viewer

          A beautiful Flutter Android app for viewing YouTube videos with a sleek dark UI.

          ![Flutter](https://img.shields.io/badge/Flutter-3.24-blue?logo=flutter)
          ![Android](https://img.shields.io/badge/Platform-Android-green?logo=android)

          ##  Features

          -  **Embedded YouTube Player**  Watch videos directly in the app with fullscreen support
          -  **JSON Import**  Load your video collection from a JSON file
          -  **JSON Export**  Share/download your current video collection as JSON
          -  **Add Videos**  Add new YouTube videos with title, URL, category & description
          -  **Categories**  Filter videos by category with animated chips
          -  **Delete Videos**  Remove videos from your collection
          -  **Custom Theming**  Set primary and accent colors via JSON config
          -  **Dark Theme**  Beautiful dark glassmorphism UI
          -  **Animations**  Smooth transitions, fade-ins, and scale effects

          ##  JSON Format

          Export the existing JSON to see the format, or create one like this:

          ```json
          {
            "app_title": "My Tutorials",
            "theme_color": "#6C63FF",
            "accent_color": "#FF6584",
            "videos": [
              {
                "id": "1",
                "title": "Flutter Tutorial",
                "url": "https://www.youtube.com/watch?v=VIDEO_ID",
                "category": "Flutter",
                "description": "Learn Flutter basics"
              }
            ]
          }
          ```

          ##  Getting Started

          ```bash
          flutter pub get
          flutter run
          ```

          ##  Build APK

          ```bash
          flutter build apk --release
          ```

          The APK will be at `build/app/outputs/flutter-apk/app-release.apk`
          README_EOF

      - name: Copy project to repo root
        run: |
          # Remove everything except .git and .github
          find . -maxdepth 1 \
            -not -name '.' \
            -not -name '..' \
            -not -name '.git' \
            -not -name '.github' \
            -not -name 'youtube_viewer_app' \
            -exec rm -rf {} + 2>/dev/null || true

          # Copy all project files to root
          shopt -s dotglob
          cp -r youtube_viewer_app/* . 2>/dev/null || true
          shopt -u dotglob

          # Clean up temp directory
          rm -rf youtube_viewer_app

      - name: Commit and push
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add -A
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m " YouTube Viewer Flutter Android App

           Build verified  tests pass, APK builds successfully

          Features:
           Embedded YouTube player with fullscreen
           JSON import/export for video management
           Add/delete videos with animated dialog
           Category filtering with gradient chips
           Dark theme with glassmorphism design
           Splash screen with entrance animations
           Customizable colors via JSON config
           Shimmer loading placeholders
           Smooth page transitions
           Press-to-scale card interactions"
            git push
          fi
